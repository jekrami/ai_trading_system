INFO:__main__:Logging to models\logs\ADA_USD_train_20250815_222916.log
INFO:__main__:No config file provided or found, using defaults.
INFO:__main__:Loading data for ADA_USD from data
INFO:agents.asset_universe:Loaded filtered data for ADA_USD: 16529 rows
INFO:__main__:Data shape: (16529, 5)
INFO:__main__:Data columns: ['close', 'high', 'low', 'open', 'volume']
INFO:__main__:Data sample: 
                              close      high       low      open  volume
datetime                                                                 
2023-06-16 20:00:00+00:00  0.263919  0.263945  0.262778  0.263616     0.0
2023-06-16 21:00:00+00:00  0.262256  0.264103  0.262170  0.263925     0.0
2023-06-16 22:00:00+00:00  0.263684  0.263805  0.262247  0.262247     0.0
D:\Work\ai_trading_system\.venv\Lib\site-packages\stable_baselines3\common\vec_env\patch_gym.py:49: UserWarning: You provided an OpenAI Gym environment. We strongly recommend transitioning to Gymnasium environments. Stable-Baselines3 is automatically wrapping your environments in a compatibility layer, which could potentially cause issues.
  warnings.warn(
D:\Work\ai_trading_system\.venv\Lib\site-packages\stable_baselines3\common\on_policy_algorithm.py:150: UserWarning: You are trying to run PPO on the GPU, but it is primarily intended to run on the CPU when not using a CNN policy (you are using ActorCriticPolicy which should be a MlpPolicy). See https://github.com/DLR-RM/stable-baselines3/issues/1245 for more info. You can pass `device='cpu'` or `export CUDA_VISIBLE_DEVICES=` to force using the CPU.Note: The model will train, but the GPU utilization will be poor and the training might take longer than on CPU.
  warnings.warn(
INFO:__main__:Starting training for ADA_USD for 100000 timesteps
INFO:agents.ppo_agent:Starting training of ADA_USD agent for 100000 timesteps
Using cuda device
Wrapping the env with a `Monitor` wrapper
Wrapping the env in a DummyVecEnv.
Logging to models\logs\ADA_USD\ADA_USD_1
----------------------------------
| time/              |           |
|    fps             | 89        |
|    iterations      | 1         |
|    time_elapsed    | 22        |
|    total_timesteps | 2048      |
| trading/           |           |
|    daily_return    | -0.000999 |
|    drawdown        | -0.501    |
|    max_drawdown    | -0.505    |
|    portfolio_value | 5.34e+03  |
|    sharpe_ratio    | -1.01     |
----------------------------------
------------------------------------------
| time/                   |              |
|    fps                  | 84           |
|    iterations           | 2            |
|    time_elapsed         | 48           |
|    total_timesteps      | 4096         |
| trading/                |              |
|    daily_return         | 0            |
|    drawdown             | -0.661       |
|    max_drawdown         | -0.702       |
|    portfolio_value      | 3.63e+03     |
|    sharpe_ratio         | -0.807       |
| train/                  |              |
|    approx_kl            | 0.0074942075 |
|    clip_fraction        | 0.0699       |
|    clip_range           | 0.2          |
|    entropy_loss         | -1.09        |
|    explained_variance   | -46.5        |
|    learning_rate        | 0.0003       |
|    loss                 | -0.0155      |
|    n_updates            | 10           |
|    policy_gradient_loss | -0.0105      |
|    value_loss           | 0.108        |
------------------------------------------
-----------------------------------------
| time/                   |             |
|    fps                  | 83          |
|    iterations           | 3           |
|    time_elapsed         | 73          |
|    total_timesteps      | 6144        |
| trading/                |             |
|    daily_return         | -0.00161    |
|    drawdown             | -0.823      |
|    max_drawdown         | -0.841      |
|    portfolio_value      | 1.89e+03    |
|    sharpe_ratio         | -0.804      |
| train/                  |             |
|    approx_kl            | 0.013400843 |
|    clip_fraction        | 0.125       |
|    clip_range           | 0.2         |
|    entropy_loss         | -1.08       |
|    explained_variance   | -4.04       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.046      |
|    n_updates            | 20          |
|    policy_gradient_loss | -0.0168     |
|    value_loss           | 0.00676     |
-----------------------------------------
-----------------------------------------
| time/                   |             |
|    fps                  | 82          |
|    iterations           | 4           |
|    time_elapsed         | 99          |
|    total_timesteps      | 8192        |
| trading/                |             |
|    daily_return         | 0           |
|    drawdown             | -0.94       |
|    max_drawdown         | -0.94       |
|    portfolio_value      | 644         |
|    sharpe_ratio         | -0.908      |
| train/                  |             |
|    approx_kl            | 0.008643854 |
|    clip_fraction        | 0.0989      |
|    clip_range           | 0.2         |
|    entropy_loss         | -1.06       |
|    explained_variance   | -0.561      |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0376     |
|    n_updates            | 30          |
|    policy_gradient_loss | -0.0165     |
|    value_loss           | 0.0021      |
-----------------------------------------
----------------------------------------
| time/                   |            |
|    fps                  | 82         |
|    iterations           | 5          |
|    time_elapsed         | 124        |
|    total_timesteps      | 10240      |
| trading/                |            |
|    daily_return         | -0.000999  |
|    drawdown             | -0.974     |
|    max_drawdown         | -0.976     |
|    portfolio_value      | 282        |
|    sharpe_ratio         | -0.955     |
| train/                  |            |
|    approx_kl            | 0.00980194 |
|    clip_fraction        | 0.113      |
|    clip_range           | 0.2        |
|    entropy_loss         | -1.05      |
|    explained_variance   | -0.349     |
|    learning_rate        | 0.0003     |
|    loss                 | -0.0459    |
|    n_updates            | 40         |
|    policy_gradient_loss | -0.0204    |
|    value_loss           | 0.00255    |
----------------------------------------
-----------------------------------------
| time/                   |             |
|    fps                  | 81          |
|    iterations           | 6           |
|    time_elapsed         | 150         |
|    total_timesteps      | 12288       |
| trading/                |             |
|    daily_return         | 0.00601     |
|    drawdown             | -0.972      |
|    max_drawdown         | -0.982      |
|    portfolio_value      | 298         |
|    sharpe_ratio         | -0.737      |
| train/                  |             |
|    approx_kl            | 0.009483882 |
|    clip_fraction        | 0.137       |
|    clip_range           | 0.2         |
|    entropy_loss         | -1.03       |
|    explained_variance   | -9.12       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0427     |
|    n_updates            | 50          |
|    policy_gradient_loss | -0.0201     |
|    value_loss           | 0.00468     |
-----------------------------------------
-----------------------------------------
| time/                   |             |
|    fps                  | 80          |
|    iterations           | 7           |
|    time_elapsed         | 177         |
|    total_timesteps      | 14336       |
| trading/                |             |
|    daily_return         | -0.00842    |
|    drawdown             | -0.987      |
|    max_drawdown         | -0.989      |
|    portfolio_value      | 138         |
|    sharpe_ratio         | -0.705      |
| train/                  |             |
|    approx_kl            | 0.010929628 |
|    clip_fraction        | 0.124       |
|    clip_range           | 0.2         |
|    entropy_loss         | -1.03       |
|    explained_variance   | 0.209       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0382     |
|    n_updates            | 60          |
|    policy_gradient_loss | -0.018      |
|    value_loss           | 0.0015      |
-----------------------------------------
-----------------------------------------
| time/                   |             |
|    fps                  | 79          |
|    iterations           | 8           |
|    time_elapsed         | 206         |
|    total_timesteps      | 16384       |
| trading/                |             |
|    daily_return         | -0.000999   |
|    drawdown             | -0.993      |
|    max_drawdown         | -0.993      |
|    portfolio_value      | 79.3        |
|    sharpe_ratio         | -0.611      |
| train/                  |             |
|    approx_kl            | 0.013196775 |
|    clip_fraction        | 0.139       |
|    clip_range           | 0.2         |
|    entropy_loss         | -1.03       |
|    explained_variance   | 0.0416      |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0107     |
|    n_updates            | 70          |
|    policy_gradient_loss | -0.0184     |
|    value_loss           | 0.00173     |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 1.65e+04    |
|    ep_rew_mean          | -4.47       |
| time/                   |             |
|    fps                  | 79          |
|    iterations           | 9           |
|    time_elapsed         | 232         |
|    total_timesteps      | 18432       |
| trading/                |             |
|    daily_return         | 0.00123     |
|    drawdown             | -0.522      |
|    max_drawdown         | -0.993      |
|    portfolio_value      | 5.23e+03    |
|    sharpe_ratio         | 0.112       |
| train/                  |             |
|    approx_kl            | 0.011053689 |
|    clip_fraction        | 0.125       |
|    clip_range           | 0.2         |
|    entropy_loss         | -1.01       |
|    explained_variance   | -0.0984     |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0372     |
|    n_updates            | 80          |
|    policy_gradient_loss | -0.0149     |
|    value_loss           | 0.00262     |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 1.65e+04    |
|    ep_rew_mean          | -4.47       |
| time/                   |             |
|    fps                  | 78          |
|    iterations           | 10          |
|    time_elapsed         | 259         |
|    total_timesteps      | 20480       |
| trading/                |             |
|    daily_return         | 0           |
|    drawdown             | -0.638      |
|    max_drawdown         | -0.993      |
|    portfolio_value      | 3.96e+03    |
|    sharpe_ratio         | 0.106       |
| train/                  |             |
|    approx_kl            | 0.011527002 |
|    clip_fraction        | 0.139       |
|    clip_range           | 0.2         |
|    entropy_loss         | -0.986      |
|    explained_variance   | -3.42       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0158     |
|    n_updates            | 90          |
|    policy_gradient_loss | -0.0211     |
|    value_loss           | 0.000889    |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 1.65e+04    |
|    ep_rew_mean          | -4.47       |
| time/                   |             |
|    fps                  | 78          |
|    iterations           | 11          |
|    time_elapsed         | 286         |
|    total_timesteps      | 22528       |
| trading/                |             |
|    daily_return         | -0.006      |
|    drawdown             | -0.809      |
|    max_drawdown         | -0.993      |
|    portfolio_value      | 2.09e+03    |
|    sharpe_ratio         | 0.101       |
| train/                  |             |
|    approx_kl            | 0.015775159 |
|    clip_fraction        | 0.188       |
|    clip_range           | 0.2         |
|    entropy_loss         | -0.977      |
|    explained_variance   | -2.78       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0562     |
|    n_updates            | 100         |
|    policy_gradient_loss | -0.0256     |
|    value_loss           | 0.000681    |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 1.65e+04    |
|    ep_rew_mean          | -4.47       |
| time/                   |             |
|    fps                  | 78          |
|    iterations           | 12          |
|    time_elapsed         | 314         |
|    total_timesteps      | 24576       |
| trading/                |             |
|    daily_return         | 0.00385     |
|    drawdown             | -0.928      |
|    max_drawdown         | -0.993      |
|    portfolio_value      | 786         |
|    sharpe_ratio         | 0.0958      |
| train/                  |             |
|    approx_kl            | 0.012757409 |
|    clip_fraction        | 0.164       |
|    clip_range           | 0.2         |
|    entropy_loss         | -0.973      |
|    explained_variance   | -0.335      |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0584     |
|    n_updates            | 110         |
|    policy_gradient_loss | -0.0191     |
|    value_loss           | 0.000453    |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 1.65e+04    |
|    ep_rew_mean          | -4.47       |
| time/                   |             |
|    fps                  | 77          |
|    iterations           | 13          |
|    time_elapsed         | 342         |
|    total_timesteps      | 26624       |
| trading/                |             |
|    daily_return         | 0           |
|    drawdown             | -0.972      |
|    max_drawdown         | -0.993      |
|    portfolio_value      | 307         |
|    sharpe_ratio         | 0.0914      |
| train/                  |             |
|    approx_kl            | 0.010470087 |
|    clip_fraction        | 0.156       |
|    clip_range           | 0.2         |
|    entropy_loss         | -0.973      |
|    explained_variance   | -2.21       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0277     |
|    n_updates            | 120         |
|    policy_gradient_loss | -0.024      |
|    value_loss           | 0.00112     |
-----------------------------------------
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 1.65e+04   |
|    ep_rew_mean          | -4.47      |
| time/                   |            |
|    fps                  | 76         |
|    iterations           | 14         |
|    time_elapsed         | 372        |
|    total_timesteps      | 28672      |
| trading/                |            |
|    daily_return         | 0          |
|    drawdown             | -0.978     |
|    max_drawdown         | -0.993     |
|    portfolio_value      | 244        |
|    sharpe_ratio         | 0.0879     |
| train/                  |            |
|    approx_kl            | 0.01122753 |
|    clip_fraction        | 0.151      |
|    clip_range           | 0.2        |
|    entropy_loss         | -0.956     |
|    explained_variance   | -4.49      |
|    learning_rate        | 0.0003     |
|    loss                 | -0.0576    |
|    n_updates            | 130        |
|    policy_gradient_loss | -0.0207    |
|    value_loss           | 0.00178    |
----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 1.65e+04    |
|    ep_rew_mean          | -4.47       |
| time/                   |             |
|    fps                  | 76          |
|    iterations           | 15          |
|    time_elapsed         | 404         |
|    total_timesteps      | 30720       |
| trading/                |             |
|    daily_return         | 0           |
|    drawdown             | -0.976      |
|    max_drawdown         | -0.993      |
|    portfolio_value      | 266         |
|    sharpe_ratio         | 0.085       |
| train/                  |             |
|    approx_kl            | 0.013028755 |
|    clip_fraction        | 0.164       |
|    clip_range           | 0.2         |
|    entropy_loss         | -0.97       |
|    explained_variance   | -1.91       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0538     |
|    n_updates            | 140         |
|    policy_gradient_loss | -0.0235     |
|    value_loss           | 0.000618    |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 1.65e+04    |
|    ep_rew_mean          | -4.47       |
| time/                   |             |
|    fps                  | 74          |
|    iterations           | 16          |
|    time_elapsed         | 438         |
|    total_timesteps      | 32768       |
| trading/                |             |
|    daily_return         | 0           |
|    drawdown             | -0.983      |
|    max_drawdown         | -0.993      |
|    portfolio_value      | 183         |
|    sharpe_ratio         | 0.0822      |
| train/                  |             |
|    approx_kl            | 0.012251452 |
|    clip_fraction        | 0.152       |
|    clip_range           | 0.2         |
|    entropy_loss         | -0.953      |
|    explained_variance   | 0.012       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0298     |
|    n_updates            | 150         |
|    policy_gradient_loss | -0.0231     |
|    value_loss           | 0.00115     |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 1.65e+04    |
|    ep_rew_mean          | -4.08       |
| time/                   |             |
|    fps                  | 73          |
|    iterations           | 17          |
|    time_elapsed         | 471         |
|    total_timesteps      | 34816       |
| trading/                |             |
|    daily_return         | 0           |
|    drawdown             | -0.45       |
|    max_drawdown         | -0.993      |
|    portfolio_value      | 6.01e+03    |
|    sharpe_ratio         | 0.106       |
| train/                  |             |
|    approx_kl            | 0.014338808 |
|    clip_fraction        | 0.151       |
|    clip_range           | 0.2         |
|    entropy_loss         | -0.959      |
|    explained_variance   | 0.145       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0416     |
|    n_updates            | 160         |
|    policy_gradient_loss | -0.024      |
|    value_loss           | 0.00114     |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 1.65e+04    |
|    ep_rew_mean          | -4.08       |
| time/                   |             |
|    fps                  | 73          |
|    iterations           | 18          |
|    time_elapsed         | 504         |
|    total_timesteps      | 36864       |
| trading/                |             |
|    daily_return         | -0.00429    |
|    drawdown             | -0.655      |
|    max_drawdown         | -0.993      |
|    portfolio_value      | 3.77e+03    |
|    sharpe_ratio         | 0.103       |
| train/                  |             |
|    approx_kl            | 0.015506435 |
|    clip_fraction        | 0.167       |
|    clip_range           | 0.2         |
|    entropy_loss         | -0.955      |
|    explained_variance   | 0.518       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0616     |
|    n_updates            | 170         |
|    policy_gradient_loss | -0.027      |
|    value_loss           | 0.000359    |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 1.65e+04    |
|    ep_rew_mean          | -4.08       |
| time/                   |             |
|    fps                  | 72          |
|    iterations           | 19          |
|    time_elapsed         | 537         |
|    total_timesteps      | 38912       |
| trading/                |             |
|    daily_return         | 0.0117      |
|    drawdown             | -0.738      |
|    max_drawdown         | -0.993      |
|    portfolio_value      | 2.87e+03    |
|    sharpe_ratio         | 0.1         |
| train/                  |             |
|    approx_kl            | 0.012126518 |
|    clip_fraction        | 0.151       |
|    clip_range           | 0.2         |
|    entropy_loss         | -0.947      |
|    explained_variance   | -0.922      |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0435     |
|    n_updates            | 180         |
|    policy_gradient_loss | -0.0242     |
|    value_loss           | 0.000607    |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 1.65e+04    |
|    ep_rew_mean          | -4.08       |
| time/                   |             |
|    fps                  | 71          |
|    iterations           | 20          |
|    time_elapsed         | 571         |
|    total_timesteps      | 40960       |
| trading/                |             |
|    daily_return         | 0.0097      |
|    drawdown             | -0.831      |
|    max_drawdown         | -0.993      |
|    portfolio_value      | 1.84e+03    |
|    sharpe_ratio         | 0.0972      |
| train/                  |             |
|    approx_kl            | 0.013745798 |
|    clip_fraction        | 0.178       |
|    clip_range           | 0.2         |
|    entropy_loss         | -0.94       |
|    explained_variance   | 0.155       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.04       |
|    n_updates            | 190         |
|    policy_gradient_loss | -0.0256     |
|    value_loss           | 0.000749    |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 1.65e+04    |
|    ep_rew_mean          | -4.08       |
| time/                   |             |
|    fps                  | 71          |
|    iterations           | 21          |
|    time_elapsed         | 602         |
|    total_timesteps      | 43008       |
| trading/                |             |
|    daily_return         | -0.000999   |
|    drawdown             | -0.922      |
|    max_drawdown         | -0.993      |
|    portfolio_value      | 857         |
|    sharpe_ratio         | 0.0945      |
| train/                  |             |
|    approx_kl            | 0.015143577 |
|    clip_fraction        | 0.169       |
|    clip_range           | 0.2         |
|    entropy_loss         | -0.939      |
|    explained_variance   | -0.0939     |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0129     |
|    n_updates            | 200         |
|    policy_gradient_loss | -0.0236     |
|    value_loss           | 0.0011      |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 1.65e+04    |
|    ep_rew_mean          | -4.08       |
| time/                   |             |
|    fps                  | 70          |
|    iterations           | 22          |
|    time_elapsed         | 638         |
|    total_timesteps      | 45056       |
| trading/                |             |
|    daily_return         | 0           |
|    drawdown             | -0.948      |
|    max_drawdown         | -0.993      |
|    portfolio_value      | 568         |
|    sharpe_ratio         | 0.0921      |
| train/                  |             |
|    approx_kl            | 0.012991942 |
|    clip_fraction        | 0.174       |
|    clip_range           | 0.2         |
|    entropy_loss         | -0.915      |
|    explained_variance   | -2.92       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0424     |
|    n_updates            | 210         |
|    policy_gradient_loss | -0.0236     |
|    value_loss           | 0.0015      |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 1.65e+04    |
|    ep_rew_mean          | -4.08       |
| time/                   |             |
|    fps                  | 69          |
|    iterations           | 23          |
|    time_elapsed         | 674         |
|    total_timesteps      | 47104       |
| trading/                |             |
|    daily_return         | -0.0417     |
|    drawdown             | -0.964      |
|    max_drawdown         | -0.993      |
|    portfolio_value      | 394         |
|    sharpe_ratio         | 0.0899      |
| train/                  |             |
|    approx_kl            | 0.013324415 |
|    clip_fraction        | 0.158       |
|    clip_range           | 0.2         |
|    entropy_loss         | -0.881      |
|    explained_variance   | -1.69       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.056      |
|    n_updates            | 220         |
|    policy_gradient_loss | -0.0229     |
|    value_loss           | 0.000552    |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 1.65e+04    |
|    ep_rew_mean          | -4.08       |
| time/                   |             |
|    fps                  | 69          |
|    iterations           | 24          |
|    time_elapsed         | 710         |
|    total_timesteps      | 49152       |
| trading/                |             |
|    daily_return         | -0.000999   |
|    drawdown             | -0.974      |
|    max_drawdown         | -0.993      |
|    portfolio_value      | 285         |
|    sharpe_ratio         | 0.0879      |
| train/                  |             |
|    approx_kl            | 0.016757958 |
|    clip_fraction        | 0.179       |
|    clip_range           | 0.2         |
|    entropy_loss         | -0.877      |
|    explained_variance   | 0.328       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0561     |
|    n_updates            | 230         |
|    policy_gradient_loss | -0.0268     |
|    value_loss           | 0.000609    |
-----------------------------------------
------------------------------------------
| rollout/                |              |
|    ep_len_mean          | 1.65e+04     |
|    ep_rew_mean          | -3.85        |
| time/                   |              |
|    fps                  | 68           |
|    iterations           | 25           |
|    time_elapsed         | 745          |
|    total_timesteps      | 51200        |
| trading/                |              |
|    daily_return         | -0.000999    |
|    drawdown             | -0.319       |
|    max_drawdown         | -0.993       |
|    portfolio_value      | 7.45e+03     |
|    sharpe_ratio         | 0.101        |
| train/                  |              |
|    approx_kl            | 0.0128907915 |
|    clip_fraction        | 0.159        |
|    clip_range           | 0.2          |
|    entropy_loss         | -0.844       |
|    explained_variance   | 0.227        |
|    learning_rate        | 0.0003       |
|    loss                 | -0.0441      |
|    n_updates            | 240          |
|    policy_gradient_loss | -0.023       |
|    value_loss           | 0.000478     |
------------------------------------------
------------------------------------------
| rollout/                |              |
|    ep_len_mean          | 1.65e+04     |
|    ep_rew_mean          | -3.85        |
| time/                   |              |
|    fps                  | 67           |
|    iterations           | 26           |
|    time_elapsed         | 783          |
|    total_timesteps      | 53248        |
| trading/                |              |
|    daily_return         | 0            |
|    drawdown             | -0.475       |
|    max_drawdown         | -0.993       |
|    portfolio_value      | 5.74e+03     |
|    sharpe_ratio         | 0.0988       |
| train/                  |              |
|    approx_kl            | 0.0143490005 |
|    clip_fraction        | 0.152        |
|    clip_range           | 0.2          |
|    entropy_loss         | -0.833       |
|    explained_variance   | 0.652        |
|    learning_rate        | 0.0003       |
|    loss                 | -0.0415      |
|    n_updates            | 250          |
|    policy_gradient_loss | -0.0248      |
|    value_loss           | 0.000511     |
------------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 1.65e+04    |
|    ep_rew_mean          | -3.85       |
| time/                   |             |
|    fps                  | 67          |
|    iterations           | 27          |
|    time_elapsed         | 824         |
|    total_timesteps      | 55296       |
| trading/                |             |
|    daily_return         | 0           |
|    drawdown             | -0.448      |
|    max_drawdown         | -0.993      |
|    portfolio_value      | 6.04e+03    |
|    sharpe_ratio         | 0.097       |
| train/                  |             |
|    approx_kl            | 0.012636129 |
|    clip_fraction        | 0.145       |
|    clip_range           | 0.2         |
|    entropy_loss         | -0.819      |
|    explained_variance   | -1.21       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.06       |
|    n_updates            | 260         |
|    policy_gradient_loss | -0.025      |
|    value_loss           | 0.000599    |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 1.65e+04    |
|    ep_rew_mean          | -3.85       |
| time/                   |             |
|    fps                  | 66          |
|    iterations           | 28          |
|    time_elapsed         | 862         |
|    total_timesteps      | 57344       |
| trading/                |             |
|    daily_return         | 0.00202     |
|    drawdown             | -0.568      |
|    max_drawdown         | -0.993      |
|    portfolio_value      | 4.73e+03    |
|    sharpe_ratio         | 0.0952      |
| train/                  |             |
|    approx_kl            | 0.014481762 |
|    clip_fraction        | 0.17        |
|    clip_range           | 0.2         |
|    entropy_loss         | -0.801      |
|    explained_variance   | 0.0248      |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0309     |
|    n_updates            | 270         |
|    policy_gradient_loss | -0.0255     |
|    value_loss           | 0.00063     |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 1.65e+04    |
|    ep_rew_mean          | -3.85       |
| time/                   |             |
|    fps                  | 65          |
|    iterations           | 29          |
|    time_elapsed         | 901         |
|    total_timesteps      | 59392       |
| trading/                |             |
|    daily_return         | 0           |
|    drawdown             | -0.74       |
|    max_drawdown         | -0.993      |
|    portfolio_value      | 2.84e+03    |
|    sharpe_ratio         | 0.0933      |
| train/                  |             |
|    approx_kl            | 0.018701594 |
|    clip_fraction        | 0.171       |
|    clip_range           | 0.2         |
|    entropy_loss         | -0.758      |
|    explained_variance   | -0.185      |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0603     |
|    n_updates            | 280         |
|    policy_gradient_loss | -0.0249     |
|    value_loss           | 0.00101     |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 1.65e+04    |
|    ep_rew_mean          | -3.85       |
| time/                   |             |
|    fps                  | 65          |
|    iterations           | 30          |
|    time_elapsed         | 942         |
|    total_timesteps      | 61440       |
| trading/                |             |
|    daily_return         | -0.00135    |
|    drawdown             | -0.815      |
|    max_drawdown         | -0.993      |
|    portfolio_value      | 2.02e+03    |
|    sharpe_ratio         | 0.0916      |
| train/                  |             |
|    approx_kl            | 0.015823059 |
|    clip_fraction        | 0.166       |
|    clip_range           | 0.2         |
|    entropy_loss         | -0.751      |
|    explained_variance   | -1.98       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0497     |
|    n_updates            | 290         |
|    policy_gradient_loss | -0.0257     |
|    value_loss           | 0.00101     |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 1.65e+04    |
|    ep_rew_mean          | -3.85       |
| time/                   |             |
|    fps                  | 64          |
|    iterations           | 31          |
|    time_elapsed         | 981         |
|    total_timesteps      | 63488       |
| trading/                |             |
|    daily_return         | 0           |
|    drawdown             | -0.843      |
|    max_drawdown         | -0.993      |
|    portfolio_value      | 1.71e+03    |
|    sharpe_ratio         | 0.09        |
| train/                  |             |
|    approx_kl            | 0.016575545 |
|    clip_fraction        | 0.188       |
|    clip_range           | 0.2         |
|    entropy_loss         | -0.757      |
|    explained_variance   | -1.91       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.037      |
|    n_updates            | 300         |
|    policy_gradient_loss | -0.0266     |
|    value_loss           | 0.000593    |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 1.65e+04    |
|    ep_rew_mean          | -3.85       |
| time/                   |             |
|    fps                  | 64          |
|    iterations           | 32          |
|    time_elapsed         | 1019        |
|    total_timesteps      | 65536       |
| trading/                |             |
|    daily_return         | 0           |
|    drawdown             | -0.843      |
|    max_drawdown         | -0.993      |
|    portfolio_value      | 1.72e+03    |
|    sharpe_ratio         | 0.0886      |
| train/                  |             |
|    approx_kl            | 0.015319953 |
|    clip_fraction        | 0.161       |
|    clip_range           | 0.2         |
|    entropy_loss         | -0.722      |
|    explained_variance   | 0.307       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0397     |
|    n_updates            | 310         |
|    policy_gradient_loss | -0.0243     |
|    value_loss           | 0.000572    |
-----------------------------------------
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 1.65e+04   |
|    ep_rew_mean          | -3.32      |
| time/                   |            |
|    fps                  | 63         |
|    iterations           | 33         |
|    time_elapsed         | 1058       |
|    total_timesteps      | 67584      |
| trading/                |            |
|    daily_return         | -0.000999  |
|    drawdown             | -0.321     |
|    max_drawdown         | -0.993     |
|    portfolio_value      | 7.43e+03   |
|    sharpe_ratio         | 0.0894     |
| train/                  |            |
|    approx_kl            | 0.01870104 |
|    clip_fraction        | 0.2        |
|    clip_range           | 0.2        |
|    entropy_loss         | -0.735     |
|    explained_variance   | -0.032     |
|    learning_rate        | 0.0003     |
|    loss                 | -0.0568    |
|    n_updates            | 320        |
|    policy_gradient_loss | -0.0284    |
|    value_loss           | 0.00049    |
----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 1.65e+04    |
|    ep_rew_mean          | -3.32       |
| time/                   |             |
|    fps                  | 63          |
|    iterations           | 34          |
|    time_elapsed         | 1097        |
|    total_timesteps      | 69632       |
| trading/                |             |
|    daily_return         | 0           |
|    drawdown             | -0.385      |
|    max_drawdown         | -0.993      |
|    portfolio_value      | 6.72e+03    |
|    sharpe_ratio         | 0.0881      |
| train/                  |             |
|    approx_kl            | 0.018548902 |
|    clip_fraction        | 0.179       |
|    clip_range           | 0.2         |
|    entropy_loss         | -0.769      |
|    explained_variance   | 0.351       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0319     |
|    n_updates            | 330         |
|    policy_gradient_loss | -0.0274     |
|    value_loss           | 0.000219    |
-----------------------------------------
Traceback (most recent call last):
  File "D:\Work\ai_trading_system\agents\train_single_agent.py", line 117, in <module>
    main() 
    ^^^^^^
  File "D:\Work\ai_trading_system\agents\train_single_agent.py", line 113, in main
    agent.train(total_timesteps=args.timesteps)
  File "D:\Work\ai_trading_system\agents\ppo_agent.py", line 161, in train
    self.model.learn(
  File "D:\Work\ai_trading_system\.venv\Lib\site-packages\stable_baselines3\ppo\ppo.py", line 311, in learn
    return super().learn(
           ^^^^^^^^^^^^^^
  File "D:\Work\ai_trading_system\.venv\Lib\site-packages\stable_baselines3\common\on_policy_algorithm.py", line 324, in learn
    continue_training = self.collect_rollouts(self.env, callback, self.rollout_buffer, n_rollout_steps=self.n_steps)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Work\ai_trading_system\.venv\Lib\site-packages\stable_baselines3\common\on_policy_algorithm.py", line 202, in collect_rollouts
    actions, values, log_probs = self.policy(obs_tensor)
                                 ^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Work\ai_trading_system\.venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Work\ai_trading_system\.venv\Lib\site-packages\torch\nn\modules\module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Work\ai_trading_system\.venv\Lib\site-packages\stable_baselines3\common\policies.py", line 654, in forward
    distribution = self._get_action_dist_from_latent(latent_pi)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Work\ai_trading_system\.venv\Lib\site-packages\stable_baselines3\common\policies.py", line 691, in _get_action_dist_from_latent
    mean_actions = self.action_net(latent_pi)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Work\ai_trading_system\.venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Work\ai_trading_system\.venv\Lib\site-packages\torch\nn\modules\module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Work\ai_trading_system\.venv\Lib\site-packages\torch\nn\modules\linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
